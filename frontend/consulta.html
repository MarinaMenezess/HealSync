<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HealSync - Detalhes da Consulta</title>
  <link rel="shortcut icon" type="imagex/png" href="../assets/logo.svg">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100..900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body id="main-body">
  <header>
    <div id="logo">
        <img src="../assets/logo.svg" alt="HealSync Logo">
        <h3>HealSync</h3>
    </div>
    <div id="nav">
        <a href="./index.html">Início</a>
           
        <a href="./registers.html" id="nav-dynamic-link">Diário</a> 
        
        <a href="./chat.html" id="nav-link-3">Chat</a>
    </div>
    <div id="info">
       <section class="notification-wrapper">
          <a href="#" id="dropdownToggle" class="notification-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="28" fill="#f1eee4" class="bi bi-bell" viewBox="0 0 16 16">
              <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6"/>
          </svg> 
              
              <span id="notification-badge" class="badge" style="display: none;"></span> 
              
              <div id="dropdownMenu" class="notification-dropdown">
                  <div class="dropdown-header">
                    <a href="./notifications.html"><h3>Notificações</h3></a>
                  </div>
                  <div class="notification-list"> 
                      </div>
                    </div>
          </a>
      </section>
        <a href="./profile.html"><img src="../assets/user-default.svg" alt="User Avatar"></a>
    </div>
</header>

  <main>
    <div class="content-container">
        <div id="loading-message" style="text-align: center; color: #7873f5; font-size: 1.2em; margin-top: 50px;">
            Carregando detalhes da consulta...
        </div>
        <div id="error-message" style="text-align: center; color: #dc3545; font-size: 1.1em; padding: 10px; border: 1px solid #dc3545; margin-top: 50px; display: none;"></div>
        
        <div id="consultation-content" style="display: none;">
            <div class="consultation-header">
                <h1 id="consultation-title">Detalhes da Consulta</h1>
                <span id="consultation-status" class="status-badge"></span>
            </div>
            
            <div id="stopwatch-container" class="stopwatch-container" style="display: none;">
                <div class="stopwatch-display">
                    <p>Controle de Tempo</p>
                    <h2 id="stopwatch-time">00:00:00</h2>
                </div>
                <div class="stopwatch-actions">
                    <button id="start-stop-btn" class="start-stop-btn start-btn">Iniciar</button>
                    <button id="reset-btn" class="reset-btn" disabled>Zerar</button>
                </div>
            </div>
            <div class="consultation-info-box">
                <p><strong>ID da Consulta:</strong> <span id="consultation-id"></span></p>
                <p><strong>Data/Hora:</strong> <span id="consultation-datetime"></span></p>
                <p id="consultation-duration-p" style="display: none;"><strong>Duração Registrada:</strong> <span id="consultation-duration"></span></p>
                <p><strong>Motivo da Solicitação:</strong> <span id="consultation-motive"></span></p>
                <p><strong>Paciente:</strong> <span id="consultation-patient-name"></span></p>
                <p><strong>Psicólogo:</strong> <span id="consultation-psychologist-name"></span></p>
                <p id="rejection-reason-p" style="color: #dc3545; display: none;"><strong>Motivo da Recusa:</strong> <span id="rejection-reason"></span></p>
            </div>
            
            <div id="evaluation-section" class="evaluation-section" style="display: none; text-align: center; margin-top: 20px;">
                <button id="rate-professional-btn" class="save-button start-btn" style="background-color: #f1eee4; color: #7873f5; border: 2px solid #7873f5; padding: 10px 20px; font-size: 1em; width: auto;">
                    Avaliar Profissional
                </button>
            </div>
            <div id="notes-section" class="notes-section">
                <div class="consultation-header">
                    <h2>Registro da Sessão</h2>
                </div>
                
                <div class="notes-area">
                    <div id="session-note-content-area">
                    </div>
                </div>
                
                <h3 class="mt-4">Histórico de Anotações do Paciente</h3>
                 <div id="notes-list-container">
                    <p id="notes-loading-message" style="text-align: center; color: #7873f5; font-size: 1em;">Carregando histórico...</p>
                </div>
            </div>
        </div>
    </div>
  </main>
  
  
  <div id="evaluation-modal" class="modal-overlay" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6);">
    <div class="modal-content" style="background-color: #333; margin: 15% auto; padding: 20px; border-radius: 10px; width: 80%; max-width: 500px; box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19); color: #f1eee4;">
        <span class="close-btn" id="close-modal-btn" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
        <h2 style="color: #7873f5; margin-bottom: 10px;">Avaliar <span id="modal-psy-name"></span></h2>
        <p style="margin-bottom: 20px; font-size: 0.9em;">Sua opinião é importante para o HealSync e para outros pacientes.</p>
        
        <div id="rating-stars" style="font-size: 2.5em; margin: 15px 0; text-align: center; cursor: pointer;">
            <span class="star" data-rating="1" style="color: #555;">★</span>
            <span class="star" data-rating="2" style="color: #555;">★</span>
            <span class="star" data-rating="3" style="color: #555;">★</span>
            <span class="star" data-rating="4" style="color: #555;">★</span>
            <span class="star" data-rating="5" style="color: #555;">★</span>
        </div>
        
        <form id="evaluation-form">
            <input type="hidden" id="modal-consultation-id">
            <input type="hidden" id="modal-psychologist-id">
            <input type="hidden" id="modal-rating-value" value="0">
            
            <textarea id="modal-comment" placeholder="Deixe um comentário sobre o seu atendimento (máx. 500 caracteres)..." rows="4" maxlength="500" required style="width: 100%; padding: 10px; margin-top: 15px; border-radius: 8px; border: 1px solid #7873f5; resize: vertical; background-color: #444; color: #f1eee4;"></textarea>
            
            <button type="submit" id="submit-evaluation-btn" class="save-button start-btn" style="width: 100%; margin-top: 20px; background-color: #7873f5; border: none; color: white;">
                Enviar Avaliação
            </button>
        </form>
        <p id="evaluation-message" style="color: #7873f5; margin-top: 10px; text-align: center; display: none;"></p>
    </div>
</div>
<script src="script.js"></script>
  <script src="consulta.js"></script> 
</body>
</html>